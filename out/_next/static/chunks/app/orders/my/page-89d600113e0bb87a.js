(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[123],{2545:function(e,t,r){Promise.resolve().then(r.bind(r,1029))},1029:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var a=r(7437),l=r(2265),s=r(9376),i=r(1723),n=r(5302),d=r(5317),o=r(4794),c=r(9763);let u=(0,c.Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);var m=r(4766),x=r(8226),p=r(2449),h=r(2660);let f=(0,c.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);var b=r(2141),v=r(4759),y=r(4320),g=r(6348);function j(){var e,t,r,c,j,N,k,w,Z,q,_,C,S,M,H,O,P,T,z,E,A,B;let I=(0,s.useRouter)(),{t:R}=(0,g.QT)(),{user:V}=(0,y.a)(),{addItem:D}=(0,v.j)(),[G,K]=(0,l.useState)([]),[L,Y]=(0,l.useState)(!0),[J,Q]=(0,l.useState)(!1),F={pending:{label:(null===(e=R.orders)||void 0===e?void 0:e.statusPending)||"Onay Bekliyor",color:"text-amber-500",bg:"bg-amber-500/20",icon:i.Z},confirmed:{label:(null===(t=R.orders)||void 0===t?void 0:t.statusConfirmed)||"Onaylandı",color:"text-blue-500",bg:"bg-blue-500/20",icon:n.Z},preparing:{label:(null===(r=R.orders)||void 0===r?void 0:r.statusPreparing)||"Hazırlanıyor",color:"text-purple-500",bg:"bg-purple-500/20",icon:d.Z},ready:{label:(null===(c=R.orders)||void 0===c?void 0:c.statusReady)||"Hazır",color:"text-green-500",bg:"bg-green-500/20",icon:o.Z},delivered:{label:(null===(j=R.orders)||void 0===j?void 0:j.statusDelivered)||"Teslim Edildi",color:"text-emerald-500",bg:"bg-emerald-500/20",icon:u},bill_requested:{label:(null===(N=R.orders)||void 0===N?void 0:N.statusBillRequested)||"Hesap İstendi",color:"text-pink-500",bg:"bg-pink-500/20",icon:m.Z},paid:{label:(null===(k=R.orders)||void 0===k?void 0:k.statusPaid)||"\xd6dendi",color:"text-gray-500",bg:"bg-gray-500/20",icon:x.Z},cancelled:{label:(null===(w=R.orders)||void 0===w?void 0:w.statusCancelled)||"İptal Edildi",color:"text-red-500",bg:"bg-red-500/20",icon:i.Z}};(0,l.useEffect)(()=>{W();let e=setInterval(W,5e3);return()=>clearInterval(e)},[V]);let W=async()=>{if(!V){Y(!1);return}let{data:e,error:t}=await b.O.from("orders").select("*").eq("user_id",V.id).order("created_at",{ascending:!1}).limit(20);if(!t&&e){let t=Array.from(new Set(e.map(e=>e.venue_id).filter(Boolean))),r={};if(t.length>0){let{data:e}=await b.O.from("venues").select("id, name").in("id",t);null==e||e.forEach(e=>{r[e.id]=e.name})}K(e.map(e=>({...e,venue_name:r[e.venue_id]||"Mekan"})))}Y(!1)},U=G.filter(e=>!["paid","cancelled","completed"].includes(e.status)),X=G.filter(e=>["paid","cancelled","completed"].includes(e.status)),$=U.reduce((e,t)=>e+(t.total||0),0),ee=async()=>{var e;for(let e of U)await b.O.from("orders").update({status:"bill_requested"}).eq("id",e.id);alert((null===(e=R.orders)||void 0===e?void 0:e.billRequested)||"Hesap istendi! Garson masanıza gelecek."),W()},et=async e=>{var t,r;for(let t of U)await b.O.from("orders").update({status:"paid",payment_method:e}).eq("id",t.id);Q(!1),alert("tit_pay"===e?(null===(t=R.orders)||void 0===t?void 0:t.titPaySuccess)||"TiT Pay ile \xf6deme başarılı!":(null===(r=R.orders)||void 0===r?void 0:r.cardPaySuccess)||"Kredi kartı ile \xf6deme başarılı!"),W()},er=async e=>{if(!e.items||0===e.items.length){var t;alert((null===(t=R.orders)||void 0===t?void 0:t.noItemsToReorder)||"Bu siparişte \xfcr\xfcn bulunamadı");return}e.items.forEach(t=>{D({id:"reorder-".concat(Date.now(),"-").concat(Math.random()),name:t.name,price:t.price||0,quantity:t.quantity||1,options:t.options||[]},e.venue_id,e.venue_name||"Mekan")}),I.push("/cart")},ea=e=>new Date(e).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return V?(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-32",children:[(0,a.jsx)("header",{className:"sticky top-0 z-50 bg-[#0a0a0a]/90 backdrop-blur border-b border-white/5 px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>I.back(),className:"p-2 hover:bg-white/10 rounded-full",children:(0,a.jsx)(h.Z,{className:"w-6 h-6"})}),(0,a.jsx)("h1",{className:"text-xl font-bold",children:(null===(Z=R.orders)||void 0===Z?void 0:Z.myOrders)||"Siparişlerim"})]})}),L?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:[U.length>0&&(0,a.jsxs)("div",{className:"mx-4 mt-4 p-4 bg-gradient-to-r from-orange-500/20 to-amber-500/20 rounded-2xl border border-orange-500/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(f,{className:"w-6 h-6 text-orange-500"}),(0,a.jsx)("span",{className:"font-semibold",children:(null===(q=R.orders)||void 0===q?void 0:q.openBill)||"A\xe7ık Hesap"})]}),(0,a.jsxs)("span",{className:"text-xl font-bold text-orange-500",children:["₺",$]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:ee,className:"flex-1 py-2 bg-orange-500/30 rounded-xl text-sm font-medium",children:(null===(_=R.orders)||void 0===_?void 0:_.requestBill)||"Hesap İste"}),(0,a.jsx)("button",{onClick:()=>Q(!0),className:"flex-1 py-2 bg-green-500/30 rounded-xl text-sm font-medium text-green-400",children:(null===(C=R.orders)||void 0===C?void 0:C.payNow)||"Şimdi \xd6de"})]})]}),U.length>0&&(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-3",children:(null===(S=R.orders)||void 0===S?void 0:S.activeOrders)||"Aktif Siparişler"}),(0,a.jsx)("div",{className:"space-y-3",children:U.map(e=>{let t=F[e.status]||F.pending,r=t.icon;return(0,a.jsxs)("div",{className:"bg-[#1a1a1a] rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"font-bold text-orange-500",children:["#",e.order_number]}),(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(t.bg," ").concat(t.color),children:[(0,a.jsx)(r,{className:"w-3 h-3 inline mr-1"}),t.label]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:e.venue_name}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:Array.isArray(e.items)&&e.items.slice(0,3).map((t,r)=>(0,a.jsxs)("span",{children:[t.quantity,"x ",t.name,r<Math.min(e.items.length,3)-1&&", "]},r))}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-white/10",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:ea(e.created_at)}),(0,a.jsxs)("span",{className:"font-bold",children:["₺",e.total]})]})]},e.id)})})]}),X.length>0&&(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-3",children:(null===(M=R.orders)||void 0===M?void 0:M.pastOrders)||"Ge\xe7miş Siparişler"}),(0,a.jsx)("div",{className:"space-y-3",children:X.map(e=>{var t;let r=F[e.status]||F.paid;return(0,a.jsxs)("div",{className:"bg-[#1a1a1a] rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"font-medium",children:["#",e.order_number]}),(0,a.jsx)("span",{className:"text-xs ".concat(r.color),children:r.label})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.venue_name}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-white/10",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:ea(e.created_at)}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"font-bold",children:["₺",e.total]}),(0,a.jsx)("button",{onClick:()=>er(e),className:"px-3 py-1 bg-orange-500/20 text-orange-500 rounded-lg text-sm",children:(null===(t=R.orders)||void 0===t?void 0:t.reorder)||"Tekrarla"})]})]})]},e.id)})})]}),0===G.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,a.jsx)(p.Z,{className:"w-16 h-16 text-gray-600 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:(null===(H=R.orders)||void 0===H?void 0:H.noOrders)||"Hen\xfcz sipariş yok"}),(0,a.jsx)("p",{className:"text-gray-400",children:(null===(O=R.orders)||void 0===O?void 0:O.startOrdering)||"Hemen sipariş vermeye başlayın"})]})]}),J&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-end",children:(0,a.jsxs)("div",{className:"w-full bg-[#1a1a1a] rounded-t-3xl p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:(null===(P=R.orders)||void 0===P?void 0:P.paymentMethod)||"\xd6deme Y\xf6ntemi"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>et("card"),className:"w-full p-4 bg-[#242424] rounded-xl flex items-center gap-3",children:[(0,a.jsx)(x.Z,{className:"w-6 h-6 text-blue-500"}),(0,a.jsx)("span",{children:(null===(T=R.orders)||void 0===T?void 0:T.payWithCard)||"Kredi Kartı ile \xd6de"})]}),(0,a.jsxs)("button",{onClick:()=>et("tit_pay"),className:"w-full p-4 bg-gradient-to-r from-purple-500/20 to-indigo-500/20 rounded-xl flex items-center gap-3 border border-purple-500/30",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-indigo-500 rounded-full flex items-center justify-center text-xs font-bold",children:"T"}),(0,a.jsx)("span",{children:"TiT Pay ile \xd6de"})]})]}),(0,a.jsx)("button",{onClick:()=>Q(!1),className:"w-full mt-4 py-3 text-gray-400",children:(null===(z=R.common)||void 0===z?void 0:z.cancel)||"İptal"})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(p.Z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:(null===(E=R.auth)||void 0===E?void 0:E.loginRequired)||"Giriş Yapın"}),(0,a.jsx)("p",{className:"text-gray-400 mb-4",children:(null===(A=R.orders)||void 0===A?void 0:A.loginToSee)||"Siparişlerinizi g\xf6rmek i\xe7in giriş yapın"}),(0,a.jsx)("button",{onClick:()=>I.push("/auth"),className:"px-6 py-3 bg-orange-500 rounded-xl font-medium",children:(null===(B=R.auth)||void 0===B?void 0:B.login)||"Giriş Yap"})]})})}},4759:function(e,t,r){"use strict";r.d(t,{CartProvider:function(){return n},j:function(){return i}});var a=r(7437),l=r(2265);let s=(0,l.createContext)(null);function i(){let e=(0,l.useContext)(s);if(!e)throw Error("useCart must be used within CartProvider");return e}function n(e){let{children:t}=e,[r,i]=(0,l.useState)([]),[n,d]=(0,l.useState)(null),[o,c]=(0,l.useState)(null),[u,m]=(0,l.useState)(!1);(0,l.useEffect)(()=>{try{let e=localStorage.getItem("order_cart");if(e){let t=JSON.parse(e);i(t.items||[]),d(t.venueId||null),c(t.venueName||null)}}catch(e){console.error("Cart load error:",e)}m(!0)},[]),(0,l.useEffect)(()=>{u&&localStorage.setItem("order_cart",JSON.stringify({items:r,venueId:n,venueName:o}))},[r,n,o,u]);let x=e=>{i(t=>{let r=t.filter(t=>t.id!==e);return 0===r.length&&(d(null),c(null)),r})},p=r.reduce((e,t)=>e+t.quantity,0),h=r.reduce((e,t)=>e+t.price*t.quantity,0);return(0,a.jsx)(s.Provider,{value:{items:r,venueId:n,venueName:o,addItem:(e,t,r)=>{if(n&&n!==t){i([{...e,quantity:e.quantity||1}]),d(t),c(r);return}d(t),c(r),i(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+(e.quantity||1)}:t):[...t,{...e,quantity:e.quantity||1}])},updateQuantity:(e,t)=>{if(t<=0){x(e);return}i(r=>r.map(r=>r.id===e?{...r,quantity:t}:r))},removeItem:x,clearCart:()=>{i([]),d(null),c(null),localStorage.removeItem("order_cart")},cartCount:p,totalPrice:h},children:t})}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4766:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},5302:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5317:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]])},1723:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8226:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},4794:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2449:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])}},function(e){e.O(0,[658,310,971,117,744],function(){return e(e.s=2545)}),_N_E=e.O()}]);