(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{9572:function(e,t,a){Promise.resolve().then(a.bind(a,7093))},7093:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),n=a(2265),r=a(9376),i=a(1723),l=a(5302),c=a(5317),d=a(9763);let o=(0,d.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var m=a(2449),x=a(2660);let h=(0,d.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var u=a(4794),p=a(2141),f=a(4320),y=a(6348);function g(){let e=(0,r.useRouter)(),{user:t,loading:a}=(0,f.a)(),{t:d,locale:g}=(0,y.QT)(),[b,j]=(0,n.useState)([]),[v,k]=(0,n.useState)(!0),[N,w]=(0,n.useState)("active"),Z={pending:{label:"Beklemede",color:"text-yellow-500 bg-yellow-500/10",icon:i.Z},confirmed:{label:"Onaylandı",color:"text-blue-500 bg-blue-500/10",icon:l.Z},preparing:{label:"Hazırlanıyor",color:"text-orange-500 bg-orange-500/10",icon:c.Z},ready:{label:"Hazır",color:"text-green-500 bg-green-500/10",icon:l.Z},served:{label:"Teslim Edildi",color:"text-emerald-500 bg-emerald-500/10",icon:l.Z},completed:{label:"Tamamlandı",color:"text-gray-500 bg-gray-500/10",icon:l.Z},cancelled:{label:"İptal Edildi",color:"text-red-500 bg-red-500/10",icon:o}},_={dine_in:"Masada",takeaway:"Paket",delivery:"Eve Servis"};(0,n.useEffect)(()=>{if(!a){if(t){M();let e=p.O.channel("customer-orders").on("postgres_changes",{event:"*",schema:"public",table:"orders",filter:"user_id=eq.".concat(t.id)},()=>M()).subscribe();return()=>{p.O.removeChannel(e)}}k(!1)}},[t,a]);let M=async()=>{if(!t)return;k(!0);let{data:e,error:a}=await p.O.from("orders").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(a){console.error("Orders fetch error:",a),k(!1);return}if(e&&e.length>0){let t=Array.from(new Set(e.map(e=>e.venue_id).filter(Boolean)));if(t.length>0){let{data:a}=await p.O.from("venues").select("id, name").in("id",t),s={};null==a||a.forEach(e=>{s[e.id]=e.name}),e.forEach(e=>{e.venue_name=s[e.venue_id]||"Mekan"})}j(e)}else j([]);k(!1)},C=e=>new Date(e).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),A=b.filter(e=>["pending","confirmed","preparing","ready"].includes(e.status)),z=b.filter(e=>["served","completed","cancelled"].includes(e.status)),E="active"===N?A:z;return a?(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):t?(0,s.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-24",children:[(0,s.jsx)("header",{className:"sticky top-0 z-40 bg-[#0a0a0a] border-b border-white/5 px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>e.back(),className:"w-10 h-10 rounded-full bg-[#1a1a1a] flex items-center justify-center",children:(0,s.jsx)(x.Z,{className:"w-5 h-5"})}),(0,s.jsx)("h1",{className:"text-xl font-bold",children:"Siparişlerim"})]}),(0,s.jsx)("button",{onClick:M,className:"w-10 h-10 rounded-full bg-[#1a1a1a] flex items-center justify-center",children:(0,s.jsx)(h,{className:"w-5 h-5 text-gray-400 ".concat(v?"animate-spin":"")})})]})}),(0,s.jsx)("div",{className:"px-4 py-3",children:(0,s.jsxs)("div",{className:"flex gap-2 p-1 bg-[#1a1a1a] rounded-xl",children:[(0,s.jsxs)("button",{onClick:()=>w("active"),className:"flex-1 py-2 rounded-lg font-medium transition-colors ".concat("active"===N?"bg-orange-500 text-white":"text-gray-400"),children:["Aktif (",A.length,")"]}),(0,s.jsxs)("button",{onClick:()=>w("past"),className:"flex-1 py-2 rounded-lg font-medium transition-colors ".concat("past"===N?"bg-orange-500 text-white":"text-gray-400"),children:["Ge\xe7miş (",z.length,")"]})]})}),(0,s.jsx)("div",{className:"px-4 space-y-4",children:v?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):0===E.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(m.Z,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-400",children:"active"===N?"Aktif sipariş yok":"Ge\xe7miş sipariş yok"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"active"===N?"Yeni bir sipariş verin":"Hen\xfcz tamamlanmış sipariş yok"})]}):E.map(t=>{let a=Z[t.status]||Z.pending,n=a.icon;return(0,s.jsxs)("button",{onClick:()=>e.push("/orders/".concat(t.id)),className:"w-full bg-[#1a1a1a] rounded-2xl p-4 text-left",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-orange-500",children:["#",t.order_number]}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:t.venue_name})]}),(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ".concat(a.color),children:[(0,s.jsx)(n,{className:"w-3 h-3"}),a.label]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-400 mb-3",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),_[t.type]||t.type,t.table_number&&" • Masa ".concat(t.table_number)]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"}),C(t.created_at)]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-300 mb-3",children:[Array.isArray(t.items)&&t.items.slice(0,3).map((e,a)=>(0,s.jsxs)("span",{children:[e.quantity,"x ",e.name,a<Math.min(t.items.length,3)-1&&", "]},a)),Array.isArray(t.items)&&t.items.length>3&&(0,s.jsxs)("span",{className:"text-gray-500",children:[" +",t.items.length-3," \xfcr\xfcn"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-white/10",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Toplam"}),(0,s.jsxs)("span",{className:"font-bold text-lg",children:["₺",t.total]})]})]},t.id)})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex items-center justify-center p-4 pb-24",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(m.Z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Giriş Yapın"}),(0,s.jsx)("p",{className:"text-gray-400 mb-4",children:"Siparişlerinizi g\xf6rmek i\xe7in giriş yapın"}),(0,s.jsx)("button",{onClick:()=>e.push("/auth"),className:"px-6 py-3 bg-orange-500 rounded-xl font-medium",children:"Giriş Yap"})]})})}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5302:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5317:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]])},1723:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4794:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2449:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])}},function(e){e.O(0,[658,310,971,117,744],function(){return e(e.s=9572)}),_N_E=e.O()}]);