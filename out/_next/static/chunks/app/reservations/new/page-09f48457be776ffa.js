(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{4894:function(e,t,n){Promise.resolve().then(n.bind(n,7038))},7038:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var a=n(7437),r=n(2265),s=n(9376),l=n(2660),i=n(1047),o=n(1723),c=n(5805),u=n(9554),d=n(9397),m=n(5863),h=n(2141),x=n(4320);function y(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),n=t.get("venue"),y=t.get("name")||"Mekan",{user:f,profile:p}=(0,x.a)(),[g,b]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[j,k]=(0,r.useState)({date:"",time:"",partySize:2,name:"",phone:"",notes:""});(0,r.useEffect)(()=>{p&&f&&k(e=>({...e,name:p.display_name||"",phone:f.phone||(null==p?void 0:p.phone)||""}))},[p,f]),(0,r.useEffect)(()=>{n&&N()},[n]);let N=async()=>{let{data:e}=await h.O.from("venues").select("*").eq("id",n).single();e&&w(e)},S=async()=>{if(!j.date||!j.time||!j.name||!j.phone){alert("L\xfctfen t\xfcm zorunlu alanları doldurun");return}b(!0);let{error:t}=await h.O.from("reservations").insert({venue_id:n,user_id:null==f?void 0:f.id,customer_name:j.name,customer_phone:j.phone,reservation_date:j.date,reservation_time:j.time,party_size:j.partySize,notes:j.notes,status:"pending"});b(!1),t?alert("Rezervasyon oluşturulamadı"):e.push("/reservations?success=1")},_=new Date().toISOString().split("T")[0];return(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-24",children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 bg-[#0a0a0a]/95 backdrop-blur border-b border-white/5 px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>e.back(),className:"w-10 h-10 rounded-full bg-[#1a1a1a] border border-white/10 flex items-center justify-center",children:(0,a.jsx)(l.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Rezervasyon Yap"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:y})]})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 inline mr-2"}),"Tarih Se\xe7in *"]}),(0,a.jsx)("input",{type:"date",min:_,value:j.date,onChange:e=>k({...j,date:e.target.value}),className:"w-full bg-[#1a1a1a] border border-white/10 rounded-xl py-3 px-4 text-white focus:outline-none focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 inline mr-2"}),"Saat Se\xe7in *"]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["12:00","12:30","13:00","13:30","14:00","14:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00"].map(e=>(0,a.jsx)("button",{onClick:()=>k({...j,time:e}),className:"py-2 rounded-lg text-sm font-medium transition-colors ".concat(j.time===e?"bg-orange-500 text-white":"bg-[#1a1a1a] border border-white/10 text-gray-400 hover:border-orange-500"),children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 inline mr-2"}),"Kişi Sayısı"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-6 bg-[#1a1a1a] border border-white/10 rounded-xl py-4",children:[(0,a.jsx)("button",{onClick:()=>k({...j,partySize:Math.max(1,j.partySize-1)}),className:"w-12 h-12 rounded-full bg-[#242424] flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5"})}),(0,a.jsx)("span",{className:"text-3xl font-bold w-12 text-center",children:j.partySize}),(0,a.jsx)("button",{onClick:()=>k({...j,partySize:Math.min(20,j.partySize+1)}),className:"w-12 h-12 rounded-full bg-[#242424] flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-5 h-5"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"İsim Soyisim *"}),(0,a.jsx)("input",{type:"text",value:j.name,onChange:e=>k({...j,name:e.target.value}),placeholder:"Adınız Soyadınız",className:"w-full bg-[#1a1a1a] border border-white/10 rounded-xl py-3 px-4 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500"}),p&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["\uD83D\uDCA1 İşletme sadece anonim ID'nizi g\xf6recek: ",p.anonymous_id]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Telefon *"}),(0,a.jsx)("input",{type:"tel",value:j.phone,onChange:e=>k({...j,phone:e.target.value}),placeholder:"05XX XXX XX XX",className:"w-full bg-[#1a1a1a] border border-white/10 rounded-xl py-3 px-4 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"\uD83D\uDD12 Telefon numaranız işletmeyle paylaşılmaz"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"\xd6zel İstekler (opsiyonel)"}),(0,a.jsx)("textarea",{value:j.notes,onChange:e=>k({...j,notes:e.target.value}),placeholder:"Doğum g\xfcn\xfc, pencere kenarı, bebek sandalyesi vs.",rows:3,className:"w-full bg-[#1a1a1a] border border-white/10 rounded-xl py-3 px-4 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500 resize-none"})]}),(0,a.jsx)("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-4",children:(0,a.jsxs)("p",{className:"text-green-400 text-sm",children:["\uD83D\uDEE1️ ",(0,a.jsx)("strong",{children:"Gizlilik G\xfcvencesi:"})," Kişisel bilgileriniz (isim, telefon) işletmeyle paylaşılmaz. İşletme sadece anonim ID'nizi (",null==p?void 0:p.anonymous_id,") ve \xf6zel isteklerinizi g\xf6r\xfcr. T\xfcm iletişim uygulama \xfczerinden yapılır."]})}),(0,a.jsx)("button",{onClick:S,disabled:g||!j.date||!j.time||!j.name||!j.phone,className:"w-full py-4 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-700 rounded-xl font-bold text-lg flex items-center justify-center gap-2 transition-colors",children:g?(0,a.jsx)(m.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),"Rezervasyon Yap"]})})]})]})}function f(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-8 h-8 animate-spin text-orange-500"})}),children:(0,a.jsx)(y,{})})}},4320:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return o},a:function(){return i}});var a=n(7437),r=n(2265),s=n(2141);let l=(0,r.createContext)({user:null,profile:null,session:null,loading:!0,signIn:()=>{},signOut:async()=>{},signInWithGoogle:async()=>{},refreshProfile:async()=>{}}),i=()=>(0,r.useContext)(l);function o(e){let{children:t}=e,[n,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),x=e=>{var t,n,a,r,s;return{id:e.id,email:e.email||"",name:(null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null===(n=e.user_metadata)||void 0===n?void 0:n.name)||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"Kullanıcı",avatar:(null===(r=e.user_metadata)||void 0===r?void 0:r.avatar_url)||(null===(s=e.user_metadata)||void 0===s?void 0:s.picture)}},y=(0,r.useCallback)(async(e,t)=>{try{let{data:n,error:a}=await s.O.from("customer_profiles").select("*").eq("user_id",e).single();if(n)return n;if((null==a?void 0:a.code)==="PGRST116"){let n={user_id:e,display_name:t,anonymous_id:function(){let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="ORD-";for(let n=0;n<6;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}()},{data:a,error:r}=await s.O.from("customer_profiles").insert(n).select().single();if(r)return console.error("Profile create error:",r),null;return a}return null}catch(e){return console.error("Profile load error:",e),null}},[]);(0,r.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:t}}=await s.O.auth.getSession();if(e&&(null==t?void 0:t.user)){let n=x(t.user);d(t),i(n);let a=await y(t.user.id,n.name);e&&c(a)}}catch(e){console.error("Auth init error:",e)}finally{e&&h(!1)}})();let{data:{subscription:t}}=s.O.auth.onAuthStateChange(async(t,n)=>{if(console.log("Auth state changed:",t),e){if("SIGNED_IN"===t&&(null==n?void 0:n.user)){let t=x(n.user);d(n),i(t);let a=await y(n.user.id,t.name);e&&c(a)}else"SIGNED_OUT"===t?(d(null),i(null),c(null)):"TOKEN_REFRESHED"===t&&n&&d(n);e&&h(!1)}});return()=>{e=!1,t.unsubscribe()}},[y]);let f=async()=>{let{error:e}=await s.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw console.error("Google sign in error:",e),e},p=async()=>{let{error:e}=await s.O.auth.signOut();e&&console.error("Sign out error:",e)},g=async()=>{n&&c(await y(n.id,n.name))};return(0,a.jsx)(l.Provider,{value:{user:n,profile:o,session:u,loading:m,signIn:e=>{i(e),c({id:"demo-profile",user_id:e.id,display_name:e.name,anonymous_id:"DEMO-"+Math.random().toString(36).substr(2,6).toUpperCase(),created_at:new Date().toISOString()})},signOut:p,signInWithGoogle:f,refreshProfile:g},children:t})}},2141:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});let a=(0,n(9066).eI)("https://ipobkbhcrkrqgbohdeea.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlwb2JrYmhjcmtycWdib2hkZWVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0MzE1MjgsImV4cCI6MjA4MDAwNzUyOH0.QaUkRsv_B3Msc9qYmE366k1x_sTe8j5GxLUO3oKKg3w",{auth:{detectSessionInUrl:!0,persistSession:!0,autoRefreshToken:!0}})},9763:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let n=(0,a.forwardRef)((n,l)=>{let{color:i="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:m,...h}=n;return(0,a.createElement)("svg",{ref:l,...r,width:o,height:o,stroke:i,strokeWidth:u?24*Number(c)/Number(o):c,className:["lucide","lucide-".concat(s(e)),d].join(" "),...h},[...t.map(e=>{let[t,n]=e;return(0,a.createElement)(t,n)}),...Array.isArray(m)?m:[m]])});return n.displayName="".concat(e),n}},2660:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},1723:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5863:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9554:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5805:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[658,971,117,744],function(){return e(e.s=4894)}),_N_E=e.O()}]);