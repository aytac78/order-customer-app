(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{2314:function(e,t,s){Promise.resolve().then(s.bind(s,5181))},5181:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(7437),n=s(2265),r=s(9376),i=s(7404),l=s(4743),c=s(2451),d=s(6275);let o=(0,s(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var u=s(9554),m=s(9397),h=s(2489),x=s(2141);function p(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)(),s=t.get("venue"),p=t.get("table"),[f,b]=(0,n.useState)(null),[j,y]=(0,n.useState)([]),[g,N]=(0,n.useState)(null),[w,k]=(0,n.useState)([]),[v,Z]=(0,n.useState)(!1),[S]=(0,n.useState)(p||""),[M,C]=(0,n.useState)(""),[q,_]=(0,n.useState)(""),[z,I]=(0,n.useState)(!0),[O,E]=(0,n.useState)(!1),[R,J]=(0,n.useState)(""),[L,Q]=(0,n.useState)(!1),A=!!s&&!!p;(0,n.useEffect)(()=>{s?G(s):I(!1)},[s]);let G=async e=>{let{data:t}=await x.O.from("venues").select("*").eq("slug",e).single();if(!t){I(!1);return}b(t);let{data:s}=await x.O.from("menu_categories").select("*").eq("venue_id",t.id).eq("is_active",!0).order("display_order"),{data:a}=await x.O.from("menu_items").select("*").eq("venue_id",t.id).eq("is_available",!0),n=(s||[]).map(e=>({...e,items:(a||[]).filter(t=>t.category_id===e.id)}));y(n),n.length>0&&N(n[0].id),I(!1)},U=e=>{A&&k(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{id:e.id,name:e.name,price:e.price,quantity:1}])},V=e=>{k(t=>{let s=t.find(t=>t.id===e);return s&&s.quantity>1?t.map(t=>t.id===e?{...t,quantity:t.quantity-1}:t):t.filter(t=>t.id!==e)})},Y=e=>{var t;return(null===(t=w.find(t=>t.id===e))||void 0===t?void 0:t.quantity)||0},B=w.reduce((e,t)=>e+t.price*t.quantity,0),K=w.reduce((e,t)=>e+t.quantity,0),W=async()=>{if(!f||0===w.length||!S)return;Q(!0);let e="ORD-".concat(Date.now().toString().slice(-6)),t=Math.round(.08*B),{data:s,error:a}=await x.O.from("orders").insert({venue_id:f.id,order_number:e,table_number:S,type:"dine_in",status:"pending",payment_status:"pending",subtotal:B,tax:t,total:B+t,customer_name:M||"Misafir",notes:q||null,items:w.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity,status:"pending"}))}).select().single();if(a){alert("Sipariş oluşturulamadı: "+a.message),Q(!1);return}await x.O.from("tables").update({status:"occupied"}).eq("venue_id",f.id).eq("table_number",S),J(s.id),E(!0),k([]),Z(!1),Q(!1)};return s?z?(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):f?O?(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex flex-col items-center justify-center p-6",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mb-6",children:(0,a.jsx)(l.Z,{className:"w-10 h-10 text-green-500"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Siparişiniz Alındı!"}),(0,a.jsx)("p",{className:"text-gray-400 mb-1",children:f.name}),(0,a.jsxs)("p",{className:"text-gray-400 mb-6",children:["Masa ",S]}),(0,a.jsxs)("p",{className:"text-orange-500 font-mono mb-8",children:["#",R.slice(0,8)]}),(0,a.jsxs)("div",{className:"w-full max-w-sm space-y-3",children:[(0,a.jsx)("button",{onClick:()=>E(!1),className:"w-full py-4 bg-orange-500 rounded-xl font-semibold",children:"Yeni Sipariş Ver"}),(0,a.jsx)("button",{onClick:()=>e.push("/orders"),className:"w-full py-4 bg-[#1a1a1a] border border-white/10 rounded-xl",children:"Siparişlerimi G\xf6r"})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-32",children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 bg-[#0a0a0a]/95 backdrop-blur border-b border-white/5 px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>e.back(),className:"w-10 h-10 rounded-full bg-[#1a1a1a] border border-white/10 flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold",children:f.name}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:A?"Masa ".concat(S):"Sadece Men\xfc"})]})]}),A&&(0,a.jsxs)("button",{onClick:()=>Z(!0),className:"relative w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),K>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center",children:K})]})]})}),!A&&(0,a.jsxs)("div",{className:"mx-4 mt-4 p-4 bg-amber-500/10 border border-amber-500/30 rounded-xl flex items-center gap-3",children:[(0,a.jsx)(o,{className:"w-5 h-5 text-amber-500"}),(0,a.jsx)("p",{className:"text-amber-500 text-sm",children:"Sipariş i\xe7in QR okutun"})]}),(0,a.jsx)("div",{className:"sticky top-[73px] z-30 bg-[#0a0a0a] border-b border-white/5",children:(0,a.jsx)("div",{className:"flex overflow-x-auto py-3 px-4 gap-2 no-scrollbar",children:j.map(e=>(0,a.jsx)("button",{onClick:()=>N(e.id),className:"flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium ".concat(g===e.id?"bg-orange-500 text-white":"bg-[#1a1a1a] text-gray-400"),children:e.name},e.id))})}),(0,a.jsx)("div",{className:"px-4 py-4",children:j.filter(e=>e.id===g).map(e=>(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-4",children:e.name}),0===e.items.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Bu kategoride \xfcr\xfcn yok"}):e.items.map(e=>{let t=Y(e.id);return(0,a.jsxs)("div",{className:"bg-[#1a1a1a] rounded-xl p-4 border border-white/5 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 pr-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-1",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-gray-400 text-sm mb-2 line-clamp-2",children:e.description}),(0,a.jsxs)("p",{className:"text-orange-500 font-bold",children:["₺",e.price]})]}),A?t>0?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>V(e.id),className:"w-8 h-8 rounded-full bg-[#242424] flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"w-6 text-center",children:t}),(0,a.jsx)("button",{onClick:()=>U(e),className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})})]}):(0,a.jsx)("button",{onClick:()=>U(e),className:"px-4 py-2 bg-orange-500 rounded-lg text-sm font-medium",children:"Ekle"}):(0,a.jsx)(o,{className:"w-5 h-5 text-gray-600"})]},e.id)})]},e.id))}),A&&K>0&&!v&&(0,a.jsx)("div",{className:"fixed bottom-20 left-4 right-4 z-50",children:(0,a.jsxs)("button",{onClick:()=>Z(!0),className:"w-full py-4 bg-orange-500 rounded-xl font-semibold flex items-center justify-center gap-3 shadow-lg",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),"Sepeti G\xf6r (",K,") - ₺",B]})}),v&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-end",children:(0,a.jsxs)("div",{className:"w-full max-h-[80vh] bg-[#1a1a1a] rounded-t-3xl flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-white/5",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Sepetim"}),(0,a.jsx)("button",{onClick:()=>Z(!1),className:"w-8 h-8 rounded-full bg-[#242424] flex items-center justify-center",children:(0,a.jsx)(h.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-4 space-y-3",children:[w.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-[#242424] rounded-xl p-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-orange-500",children:["₺",e.price," x ",e.quantity]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>V(e.id),className:"w-8 h-8 rounded-full bg-[#1a1a1a] flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"w-6 text-center",children:e.quantity}),(0,a.jsx)("button",{onClick:()=>U({id:e.id,name:e.name,price:e.price,description:"",category_id:""}),className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})})]})]},e.id)),(0,a.jsx)("input",{type:"text",placeholder:"İsminiz (opsiyonel)",value:M,onChange:e=>C(e.target.value),className:"w-full px-4 py-3 bg-[#242424] rounded-xl border border-white/5 outline-none"}),(0,a.jsx)("input",{type:"text",placeholder:"Sipariş notu (opsiyonel)",value:q,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 bg-[#242424] rounded-xl border border-white/5 outline-none"})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-white/5",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Toplam"}),(0,a.jsxs)("span",{className:"text-2xl font-bold",children:["₺",B]})]}),(0,a.jsx)("button",{onClick:W,disabled:L,className:"w-full py-4 bg-orange-500 rounded-xl font-semibold flex items-center justify-center gap-2 disabled:opacity-50",children:L?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"w-5 h-5"}),"Siparişi G\xf6nder"]})})]})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex items-center justify-center",children:(0,a.jsx)("p",{children:"Mekan bulunamadı"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex flex-col items-center justify-center p-6",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full bg-purple-500/20 flex items-center justify-center mb-6",children:(0,a.jsx)(i.Z,{className:"w-12 h-12 text-purple-500"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"QR Kod Okutun"}),(0,a.jsx)("p",{className:"text-gray-400 text-center mb-8",children:"Sipariş vermek i\xe7in masanızdaki QR kodu okutun"}),(0,a.jsx)("button",{onClick:()=>e.push("/discover"),className:"px-6 py-3 bg-[#1a1a1a] border border-white/10 rounded-xl",children:"Mekanları Keşfet"})]})}function f(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}),children:(0,a.jsx)(p,{})})}},2141:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});let a=(0,s(9066).eI)("https://ipobkbhcrkrqgbohdeea.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlwb2JrYmhjcmtycWdib2hkZWVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0MzE1MjgsImV4cCI6MjA4MDAwNzUyOH0.QaUkRsv_B3Msc9qYmE366k1x_sTe8j5GxLUO3oKKg3w",{auth:{detectSessionInUrl:!0,persistSession:!0,autoRefreshToken:!0}})},9763:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let s=(0,a.forwardRef)((s,i)=>{let{color:l="currentColor",size:c=24,strokeWidth:d=2,absoluteStrokeWidth:o,className:u="",children:m,...h}=s;return(0,a.createElement)("svg",{ref:i,...n,width:c,height:c,stroke:l,strokeWidth:o?24*Number(d)/Number(c):d,className:["lucide","lucide-".concat(r(e)),u].join(" "),...h},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},2451:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9554:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7404:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},4743:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},6275:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[658,971,117,744],function(){return e(e.s=2314)}),_N_E=e.O()}]);