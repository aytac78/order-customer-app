(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{127:function(e,t,r){Promise.resolve().then(r.bind(r,7340))},7340:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(7437),s=r(9376),n=r(4320),i=r(3247),l=r(4794),c=r(2023),o=r(3774),d=r(7404),u=r(1047),h=r(1723),m=r(5805),f=r(407),x=r(8997),p=r(2265),y=r(2141);function g(){var e;let t=(0,s.useRouter)(),{user:r}=(0,n.a)(),[g,k]=(0,p.useState)(null);(0,p.useEffect)(()=>{r&&v()},[r]);let v=async()=>{if(r)try{let e=new Date().toISOString().split("T")[0],{data:t,error:a}=await y.O.from("reservations").select("*").eq("user_id",r.id).gte("reservation_date",e).in("status",["pending","confirmed"]).order("reservation_date",{ascending:!0}).limit(1);if(a){console.log("Reservations query error:",a.message);return}if(t&&t.length>0){let e=t[0],r="Mekan";if(e.venue_id){let{data:t}=await y.O.from("venues").select("name").eq("id",e.venue_id).single();t&&(r=t.name)}k({id:e.id,venue_name:r,date:e.reservation_date,time:e.reservation_time,party_size:e.party_size,status:e.status})}}catch(e){console.log("Reservation load error:",e)}},b=[{id:"discover",title:"Keşfet",subtitle:"Mekanları keşfet",icon:i.Z,gradient:"from-orange-500 to-red-500",href:"/discover"},{id:"takeaway",title:"Paket Al",subtitle:"Paket sipariş ver",icon:l.Z,gradient:"from-purple-500 to-pink-500",href:"/discover?mode=takeaway"},{id:"events",title:"Etkinlikler",subtitle:"Yakındaki etkinlikler",icon:c.Z,gradient:"from-green-500 to-emerald-500",href:"/events"},{id:"here",title:"HERE",subtitle:"Buradakiler",icon:o.Z,gradient:"from-blue-500 to-cyan-500",href:"/here"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-24",children:[(0,a.jsxs)("header",{className:"px-4 pt-12 pb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:r?"Merhaba, ".concat((null===(e=r.name)||void 0===e?void 0:e.split(" ")[0])||"Kullanıcı"):"Hoş Geldin"}),(0,a.jsx)("p",{className:"text-gray-400 mt-1",children:"Ne yapmak istersin?"})]}),(0,a.jsx)("div",{className:"px-4 grid grid-cols-2 gap-3",children:b.map(e=>(0,a.jsxs)("button",{onClick:()=>t.push(e.href),className:"p-4 rounded-2xl bg-gradient-to-br ".concat(e.gradient," text-left transition-transform active:scale-95"),children:[(0,a.jsx)(e.icon,{className:"w-8 h-8 mb-3"}),(0,a.jsx)("h3",{className:"font-semibold",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-white/70",children:e.subtitle})]},e.id))}),(0,a.jsxs)("div",{className:"px-4 mt-4 grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>t.push("/scan"),className:"py-3 bg-[#1a1a1a] rounded-xl border border-white/10 flex items-center justify-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-orange-500"}),(0,a.jsx)("span",{className:"font-medium",children:"QR Tara"})]}),(0,a.jsxs)("button",{onClick:()=>t.push("/reservations"),className:"py-3 bg-[#1a1a1a] rounded-xl border border-white/10 flex items-center justify-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-blue-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Rezervasyon"})]})]}),g&&(0,a.jsxs)("div",{className:"px-4 mt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Yaklaşan Rezervasyon"}),(0,a.jsx)("button",{onClick:()=>t.push("/reservations"),className:"w-full bg-[#1a1a1a] rounded-xl p-4 text-left border border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:g.venue_name}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-400",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),g.date]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),g.time]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),g.party_size," kişi"]})]})]}),(0,a.jsx)(f.Z,{className:"w-5 h-5 text-gray-400"})]})})]}),r&&(0,a.jsxs)("div",{className:"px-4 mt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Hızlı Erişim"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>t.push("/orders"),className:"bg-[#1a1a1a] rounded-xl p-4 text-left border border-white/10",children:[(0,a.jsx)(l.Z,{className:"w-6 h-6 text-orange-500 mb-2"}),(0,a.jsx)("h3",{className:"font-medium",children:"Siparişlerim"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Aktif siparişleri g\xf6r"})]}),(0,a.jsxs)("button",{onClick:()=>t.push("/favorites"),className:"bg-[#1a1a1a] rounded-xl p-4 text-left border border-white/10",children:[(0,a.jsx)(x.Z,{className:"w-6 h-6 text-red-500 mb-2"}),(0,a.jsx)("h3",{className:"font-medium",children:"Favorilerim"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Favori mekanlar"})]})]})]})]})}},4320:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return c},a:function(){return l}});var a=r(7437),s=r(2265),n=r(2141);let i=(0,s.createContext)({user:null,profile:null,session:null,loading:!0,signIn:()=>{},signOut:async()=>{},signInWithGoogle:async()=>{},refreshProfile:async()=>{}}),l=()=>(0,s.useContext)(i);function c(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[c,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[h,m]=(0,s.useState)(!0),f=e=>{var t,r,a,s,n;return{id:e.id,email:e.email||"",name:(null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null===(r=e.user_metadata)||void 0===r?void 0:r.name)||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"Kullanıcı",avatar:(null===(s=e.user_metadata)||void 0===s?void 0:s.avatar_url)||(null===(n=e.user_metadata)||void 0===n?void 0:n.picture)}},x=(0,s.useCallback)(async(e,t)=>{try{let{data:r,error:a}=await n.O.from("customer_profiles").select("*").eq("user_id",e).single();if(r)return r;if((null==a?void 0:a.code)==="PGRST116"){let r={user_id:e,display_name:t,anonymous_id:function(){let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="ORD-";for(let r=0;r<6;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}()},{data:a,error:s}=await n.O.from("customer_profiles").insert(r).select().single();if(s)return console.error("Profile create error:",s),null;return a}return null}catch(e){return console.error("Profile load error:",e),null}},[]);(0,s.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:t}}=await n.O.auth.getSession();if(e&&(null==t?void 0:t.user)){let r=f(t.user);u(t),l(r);let a=await x(t.user.id,r.name);e&&o(a)}}catch(e){console.error("Auth init error:",e)}finally{e&&m(!1)}})();let{data:{subscription:t}}=n.O.auth.onAuthStateChange(async(t,r)=>{if(console.log("Auth state changed:",t),e){if("SIGNED_IN"===t&&(null==r?void 0:r.user)){let t=f(r.user);u(r),l(t);let a=await x(r.user.id,t.name);e&&o(a)}else"SIGNED_OUT"===t?(u(null),l(null),o(null)):"TOKEN_REFRESHED"===t&&r&&u(r);e&&m(!1)}});return()=>{e=!1,t.unsubscribe()}},[x]);let p=async()=>{let{error:e}=await n.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw console.error("Google sign in error:",e),e},y=async()=>{let{error:e}=await n.O.auth.signOut();e&&console.error("Sign out error:",e)},g=async()=>{r&&o(await x(r.id,r.name))};return(0,a.jsx)(i.Provider,{value:{user:r,profile:c,session:d,loading:h,signIn:e=>{l(e),o({id:"demo-profile",user_id:e.id,display_name:e.name,anonymous_id:"DEMO-"+Math.random().toString(36).substr(2,6).toUpperCase(),created_at:new Date().toISOString()})},signOut:y,signInWithGoogle:p,refreshProfile:g},children:t})}},2141:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});let a=(0,r(9066).eI)("https://ipobkbhcrkrqgbohdeea.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlwb2JrYmhjcmtycWdib2hkZWVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0MzE1MjgsImV4cCI6MjA4MDAwNzUyOH0.QaUkRsv_B3Msc9qYmE366k1x_sTe8j5GxLUO3oKKg3w",{auth:{detectSessionInUrl:!0,persistSession:!0,autoRefreshToken:!0}})},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{color:l="currentColor",size:c=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:u="",children:h,...m}=r;return(0,a.createElement)("svg",{ref:i,...s,width:c,height:c,stroke:l,strokeWidth:d?24*Number(o)/Number(c):o,className:["lucide","lucide-".concat(n(e)),u].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},407:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1723:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8997:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},3774:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4794:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},7404:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},3247:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2023:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[658,971,117,744],function(){return e(e.s=127)}),_N_E=e.O()}]);