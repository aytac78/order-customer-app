(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{3579:function(e,t,a){Promise.resolve().then(a.bind(a,3850))},3850:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var n=a(7437),s=a(2265),i=a(9376),c=a(1047),r=a(8226),l=a(6595),o=a(9763);let d=(0,o.Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var m=a(3417),x=a(1197),u=a(4766),f=a(2451),h=a(2489);let y=(0,o.Z)("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]);var p=a(2141),b=a(4320),g=a(6348);let N={reservation_confirmed:c.Z,reservation:c.Z,payment:r.Z,review:l.Z,promo:d,message:m.Z,waiter_call:x.Z,default:u.Z};function j(){var e,t,a,c;let r=(0,i.useRouter)(),{user:l}=(0,b.a)(),{t:o,locale:d}=(0,g.QT)(),[m,x]=(0,s.useState)([]),[j,v]=(0,s.useState)(!0),[k,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{Z();let e=p.O.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},()=>Z()).subscribe();return()=>{p.O.removeChannel(e)}},[l]);let Z=async()=>{let e=p.O.from("notifications").select("*").order("created_at",{ascending:!1}).limit(50);l&&(e=e.eq("user_id",l.id));let{data:t,error:a}=await e;!a&&t&&x(t),v(!1)},_=async e=>{await p.O.from("notifications").update({is_read:!0}).eq("id",e),x(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t))},C=async()=>{let e=m.filter(e=>!e.is_read).map(e=>e.id);0!==e.length&&(await p.O.from("notifications").update({is_read:!0}).in("id",e),x(e=>e.map(e=>({...e,is_read:!0}))))},E=e=>{_(e.id),w(e)},T=e=>{if(!e.data)return;let{venue_name:t,date:a,time:n,guests:s}=e.data,i=new Date("".concat(a,"T").concat(n)),c=new Date(i.getTime()+72e5),r=e=>e.toISOString().replace(/-|:|\.\d+/g,"").slice(0,15)+"Z",l={title:"".concat(o.notifications.reservation," - ").concat(t),description:"".concat(s," ").concat(o.reservations.person),start:r(i),end:r(c),location:t},d="https://www.google.com/calendar/render?action=TEMPLATE&text=".concat(encodeURIComponent(l.title),"&dates=").concat(l.start,"/").concat(l.end,"&details=").concat(encodeURIComponent(l.description),"&location=").concat(encodeURIComponent(l.location));if(/iPad|iPhone|iPod/.test(navigator.userAgent)){let e=new Blob(["BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nDTSTART:".concat(l.start,"\nDTEND:").concat(l.end,"\nSUMMARY:").concat(l.title,"\nDESCRIPTION:").concat(l.description,"\nLOCATION:").concat(l.location,"\nEND:VEVENT\nEND:VCALENDAR")],{type:"text/calendar;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="reservation.ics",a.click(),URL.revokeObjectURL(t)}else window.open(d,"_blank")},M=e=>{let t=new Date(e),a=new Date().getTime()-t.getTime(),n=Math.floor(a/6e4),s=Math.floor(a/36e5);return n<60?"".concat(n," ").concat(o.notifications.minutesAgo||"dk \xf6nce"):s<24?"".concat(s," ").concat(o.notifications.hoursAgo||"saat \xf6nce"):"".concat(Math.floor(a/864e5)," ").concat(o.notifications.daysAgo||"g\xfcn \xf6nce")},R=m.filter(e=>!e.is_read).length;return j?(0,n.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] flex items-center justify-center",children:(0,n.jsx)("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):(0,n.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-24",children:[(0,n.jsx)("header",{className:"sticky top-0 z-40 bg-[#0a0a0a]/95 backdrop-blur border-b border-white/5 px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("button",{onClick:()=>r.back(),className:"w-10 h-10 rounded-full bg-[#1a1a1a] border border-white/10 flex items-center justify-center",children:(0,n.jsx)(f.Z,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h1",{className:"text-xl font-bold",children:o.notifications.title}),R>0&&(0,n.jsxs)("p",{className:"text-gray-400 text-sm",children:[R," ",o.notifications.unread||"okunmamış"]})]}),R>0&&(0,n.jsx)("button",{onClick:C,className:"text-orange-500 text-sm font-medium",children:o.notifications.markAllRead})]})}),(0,n.jsx)("main",{className:"px-4 py-6",children:m.length>0?(0,n.jsx)("div",{className:"space-y-3",children:m.map(e=>{let t=N[e.type]||N.default;return(0,n.jsx)("div",{onClick:()=>E(e),className:"rounded-2xl p-4 border cursor-pointer active:scale-[0.98] transition-transform ".concat(e.is_read?"bg-[#1a1a1a] border-white/5":"bg-orange-500/10 border-orange-500/30"),children:(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center ".concat(e.is_read?"bg-[#242424]":"bg-orange-500/20"),children:(0,n.jsx)(t,{className:"w-6 h-6 ".concat(e.is_read?"text-gray-400":"text-orange-500")})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,n.jsx)("h3",{className:"font-semibold",children:e.title}),!e.is_read&&(0,n.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-2"})]}),(0,n.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:e.message}),(0,n.jsx)("p",{className:"text-gray-600 text-xs",children:M(e.created_at)})]})]})},e.id)})}):(0,n.jsxs)("div",{className:"text-center py-20",children:[(0,n.jsx)(u.Z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,n.jsx)("h3",{className:"text-xl font-semibold mb-2",children:o.notifications.noNotifications}),(0,n.jsx)("p",{className:"text-gray-400",children:o.notifications.noNotificationsDesc})]})}),k&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-[#121212] rounded-2xl w-full max-w-sm overflow-hidden",children:[(0,n.jsxs)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-4 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-lg font-bold",children:k.title}),(0,n.jsx)("button",{onClick:()=>w(null),className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center",children:(0,n.jsx)(h.Z,{className:"w-5 h-5"})})]}),(0,n.jsxs)("div",{className:"p-4 space-y-3",children:[(null===(e=k.data)||void 0===e?void 0:e.venue_name)&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-400",children:o.common.venue}),(0,n.jsx)("span",{className:"font-medium",children:k.data.venue_name})]}),(null===(t=k.data)||void 0===t?void 0:t.date)&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-400",children:o.reservations.date}),(0,n.jsx)("span",{className:"font-medium",children:k.data.date})]}),(null===(a=k.data)||void 0===a?void 0:a.time)&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-400",children:o.reservations.time}),(0,n.jsx)("span",{className:"font-medium",children:k.data.time})]}),(null===(c=k.data)||void 0===c?void 0:c.guests)&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-400",children:o.reservations.guests}),(0,n.jsxs)("span",{className:"font-medium",children:[k.data.guests," ",o.reservations.person]})]}),(0,n.jsx)("p",{className:"text-gray-500 text-sm pt-2 border-t border-white/5",children:M(k.created_at)})]}),(0,n.jsxs)("div",{className:"p-4 border-t border-white/5 space-y-2",children:[("reservation_confirmed"===k.type||"reservation"===k.type)&&k.data&&(0,n.jsxs)("button",{onClick:()=>T(k),className:"w-full py-3 bg-green-600 rounded-xl font-medium flex items-center justify-center gap-2",children:[(0,n.jsx)(y,{className:"w-5 h-5"}),o.notifications.addToCalendar||"Takvime Ekle"]}),(0,n.jsx)("button",{onClick:()=>w(null),className:"w-full py-3 bg-orange-500 rounded-xl font-medium",children:o.common.ok})]})]})})]})}},4766:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},1047:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},2451:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1197:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]])},8226:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},3417:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},6595:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[658,310,971,117,744],function(){return e(e.s=3579)}),_N_E=e.O()}]);