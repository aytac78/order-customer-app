(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{7518:function(e,a,s){Promise.resolve().then(s.bind(s,633))},633:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return k}});var t=s(7437),l=s(2265),n=s(9376),i=s(2023),c=s(2660),r=s(2208),d=s(7769),m=s(8728),o=s(5287),x=s(1197),u=s(5863),h=s(9763);let p=(0,h.Z)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var g=s(5805),b=s(3774);let j=(0,h.Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);var f=s(3001),y=s(4320),v=s(3055),N=s(2141);function k(){let e=(0,n.useRouter)(),{user:a}=(0,y.a)(),{location:s}=(0,v.T)(),{nearbyUsers:h,settings:b,loading:j,updateSettings:k,fetchNearbyUsers:_,checkInToVenue:Z}=(0,f.o)(),[C,M]=(0,l.useState)("nearby"),[z,E]=(0,l.useState)(1),[S,q]=(0,l.useState)([]),[L,O]=(0,l.useState)(!1);(0,l.useEffect)(()=>{b.is_discoverable&&_(z),Y()},[z,b.is_discoverable]);let Y=async()=>{if(!s)return;O(!0);let{data:e}=await N.O.from("venues").select("id, name, district").limit(20);e&&q((await Promise.all(e.map(async e=>{let{count:a}=await N.O.from("venue_checkins").select("*",{count:"exact",head:!0}).eq("venue_id",e.id).eq("is_active",!0);return{...e,user_count:a||0}}))).sort((e,a)=>a.user_count-e.user_count)),O(!1)},K=async a=>{await Z(a,"manual")&&e.push("/here/venue/".concat(a))},F=a=>{e.push("/messages/new?user=".concat(a))};return a?(0,t.jsxs)("div",{className:"min-h-screen bg-[#0a0a0a] text-white pb-24",children:[(0,t.jsxs)("header",{className:"sticky top-0 bg-gradient-to-b from-purple-900/50 to-[#0a0a0a] px-4 py-4 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:()=>e.back(),className:"p-2 -ml-2",children:(0,t.jsx)(c.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:["HERE",b.is_discoverable&&(0,t.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:(null==s?void 0:s.district)||"Konum alınıyor..."})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>k({is_discoverable:!b.is_discoverable}),className:"p-2 rounded-lg transition-colors ".concat(b.is_discoverable?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-400"),children:b.is_discoverable?(0,t.jsx)(r.Z,{className:"w-5 h-5"}):(0,t.jsx)(d.Z,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>e.push("/here/settings"),className:"p-2 rounded-lg bg-gray-700 text-gray-400",children:(0,t.jsx)(m.Z,{className:"w-5 h-5"})})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>M("nearby"),className:"flex-1 py-2 rounded-xl font-medium transition-colors ".concat("nearby"===C?"bg-purple-500 text-white":"bg-[#1a1a1a] text-gray-400"),children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 inline mr-2"}),"Yakındakiler"]}),(0,t.jsxs)("button",{onClick:()=>M("venues"),className:"flex-1 py-2 rounded-xl font-medium transition-colors ".concat("venues"===C?"bg-purple-500 text-white":"bg-[#1a1a1a] text-gray-400"),children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 inline mr-2"}),"Mekanlar"]})]})]}),(0,t.jsx)("div",{className:"p-4",children:"nearby"===C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex gap-2 mb-4",children:[.5,1,3,5].map(e=>(0,t.jsx)("button",{onClick:()=>E(e),className:"flex-1 py-2 rounded-xl text-sm transition-colors ".concat(z===e?"bg-pink-500 text-white":"bg-[#1a1a1a] text-gray-400"),children:e<1?"".concat(1e3*e,"m"):"".concat(e,"km")},e))}),b.is_discoverable?j?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(u.Z,{className:"w-10 h-10 text-purple-400 mx-auto mb-4 animate-spin"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Yakındakiler aranıyor..."})]}):h.length>0?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:[h.length," kişi ",z<1?"".concat(1e3*z,"m"):"".concat(z,"km")," i\xe7inde"]}),h.map(e=>(0,t.jsx)(w,{user:e,onChat:()=>F(e.user_id)},e.user_id))]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(p,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Yakınında Kimse Yok"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Mesafeyi artırarak daha fazla kişi bulabilirsin"})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(d.Z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"G\xf6r\xfcnmez Moddasın"}),(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:"Başkalarını g\xf6rmek i\xe7in keşfedilebilir ol"}),(0,t.jsx)("button",{onClick:()=>k({is_discoverable:!0,show_nearby:!0}),className:"px-6 py-2 bg-purple-500 rounded-xl",children:"Keşfedilebilir Ol"})]})]}):(0,t.jsx)(t.Fragment,{children:L?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(u.Z,{className:"w-10 h-10 text-orange-400 mx-auto mb-4 animate-spin"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Mekanlar y\xfckleniyor..."})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:[S.filter(e=>e.user_count>0).length," mekanda aktif kullanıcı"]}),S.map(e=>(0,t.jsxs)("div",{className:"bg-[#1a1a1a] rounded-xl p-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center ".concat(e.user_count>0?"bg-orange-500/20":"bg-gray-700"),children:(0,t.jsx)(x.Z,{className:"w-6 h-6 ".concat(e.user_count>0?"text-orange-400":"text-gray-500")})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.district})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.user_count>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-orange-400",children:[(0,t.jsx)(g.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:e.user_count})]}),(0,t.jsx)("button",{onClick:()=>K(e.id),className:"px-3 py-1.5 bg-purple-500/20 text-purple-400 rounded-lg text-sm",children:"Check-in"})]})]},e.id))]})})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(i.Z,{className:"w-16 h-16 text-purple-400 mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-xl font-bold mb-2",children:"HERE - Sosyal Keşif"}),(0,t.jsx)("p",{className:"text-gray-400 mb-6",children:"Etrafındakileri keşfetmek i\xe7in giriş yap"}),(0,t.jsx)("button",{onClick:()=>e.push("/auth"),className:"px-8 py-3 bg-purple-500 rounded-xl font-medium",children:"Giriş Yap"})]})})}function w(e){var a,s,l,n,i,c;let{user:r,onChat:d}=e,m=r.distance_km<1?"".concat(Math.round(1e3*r.distance_km),"m"):"".concat(r.distance_km.toFixed(1),"km");return(0,t.jsxs)("div",{className:"bg-[#1a1a1a] rounded-xl p-4 flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center overflow-hidden",children:(null===(a=r.profile)||void 0===a?void 0:a.avatar_url)?(0,t.jsx)("img",{src:r.profile.avatar_url,alt:"",className:"w-full h-full object-cover"}):(0,t.jsx)("span",{className:"text-lg font-bold text-white",children:(null===(n=r.profile)||void 0===n?void 0:null===(l=n.display_name)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.toUpperCase())||"?"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:(null===(i=r.profile)||void 0===i?void 0:i.display_name)||"Anonim"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)(b.Z,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:[m," uzakta"]})]}),(null===(c=r.profile)||void 0===c?void 0:c.bio)&&(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-1 line-clamp-1",children:r.profile.bio})]}),(0,t.jsx)("button",{onClick:d,className:"p-3 rounded-xl bg-purple-500/20 text-purple-400 hover:bg-purple-500/30 transition-colors",children:(0,t.jsx)(j,{className:"w-5 h-5"})})]})}},5863:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8728:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2023:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9763).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},5805:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[658,701,971,117,744],function(){return e(e.s=7518)}),_N_E=e.O()}]);